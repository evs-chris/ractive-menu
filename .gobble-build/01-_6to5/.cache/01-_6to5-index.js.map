{"version":3,"sources":["/home/chris/development/js/ractive-menu/src/index.js"],"names":[],"mappings":"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","file":"unknown","sourcesContent":["/* global Ractive */\n\nvar windowOffset = function windowOffset(which, el) {\n  var total = el['offset' + which];\n  return !!el.offsetParent ? windowOffset(which, el.offsetParent) + total : total;\n};\n\nfunction positionLiChild(e) {\n  var li = e.node;\n  var ul = li.querySelector('ul');\n  if (!!ul) {\n    if (li.parentNode.parentNode.tagName !== 'LI') { // hey... it's a top-level...\n      ul.style.top = li.clientHeight + 'px';\n      if (ul.clientWidth + li.offsetLeft > window.innerWidth) ul.style.left = (li.clientWidth - ul.clientWidth) + 'px';\n      else ul.style.left = '0px';\n    } else { // farther down\n      ul.style.top = '0px';\n      if (ul.clientWidth + windowOffset('Left', li) + li.clientWidth > window.innerWidth) ul.style.left = -(ul.offsetWidth) + 'px';\n      else ul.style.left = li.clientWidth + 'px';\n    }\n  }\n}\n\nfunction parents(el, arr) {\n  arr = arr || [];\n  if (el.tagName === 'LI') arr.push(el);\n  else if (el.tagName === 'UL' && el.classList.contains('ractive-menu')) return arr;\n  return parents(el.parentNode, arr);\n}\n\nfunction closeExcept(except) {\n  var cls = this.get('openClass') || 'rm-open';\n  var opened = this.findAll('li.' + cls);\n  for (var i = 0; i < opened.length; i++) if (except.indexOf(opened[i]) === -1) opened[i].classList.remove(cls);\n  return cls;\n}\n\nvar Menu = Ractive.extend({\n  template: '<ul class=\"ractive-menu{{#horizontal}} horizontal{{/}}{{#dropdown}} dropdown{{/}}\">{{#children}}{{>menu}}{{/}}</ul>',\n  partials: {\n    menu: \"{{>(.type || 'item')}}\",\n    item: \"<li on-mouseover='enter' on-mouseout='leave' class='{{#(.children.length > 0)}}with-children{{/}}{{#.position}} {{position}}{{/}}{{#(!!.action)}} actionable{{/}}'><a href='#' on-click='clicked'>{{.label}}</a>{{#(.children.length > 0)}}<ul>{{#.children}}{{>menu}}{{/}}</ul>{{/}}</li>\",\n    separator: \"<li class='separator'></li>\"\n  },\n  data: {\n    openClass: '',\n    horizontal: true,\n    dropdown: true,\n    closeOnClick: true\n  },\n  onrender() {\n    var menu = this;\n    menu.on('clicked', function(e) {\n      var close = menu.get('closeOnClick');\n      var fn = e.context.action;\n      if (!!fn && typeof fn === 'function') {\n        if (close) closeExcept.call(menu, []);\n        fn();\n      }\n      else if (!!fn) {\n        var other = menu.get('otherAction');\n        if (!!other && typeof other === 'function') {\n          if (close) closeExcept.call(menu, []);\n          other(fn);\n        }\n      }\n      e.original.preventDefault();\n    });\n    menu.on('enter', function(e) {\n      var cls = closeExcept.call(menu, parents(e.original.target));\n      positionLiChild(e);\n      if (!!e.node.querySelector('ul')) {\n        e.node.classList.add(cls);\n        if (!!e.node.timeout) {\n          clearTimeout(e.node.timeout);\n          delete e.node.timeout;\n        }\n      }\n    });\n    menu.on('leave', function(e) {\n      if (!!e.node.timeout) {\n        clearTimeout(e.node.timeout);\n      }\n      e.node.timeout = setTimeout(function() {\n        var cls = menu.get('openClass') || 'rm-open';\n        e.node.classList.remove(cls);\n        var ul = e.node.querySelector('ul');\n        if (!!ul) {\n          ul.style.top = ul.style.left = '';\n        }\n      }, menu.get('timeout') || 300);\n    });\n  }\n});\n\nexport default Menu;\n"]}